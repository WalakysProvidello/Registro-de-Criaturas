<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Imperius Archive ‚Äì Registro de Criaturas</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=MedievalSharp&family=Cinzel+Decorative:wght@700&display=swap');

    body {
      background: radial-gradient(circle at center, #1b1b1b, #0e0e0e 90%);
      background-image: url('https://www.transparenttextures.com/patterns/aged-paper.png');
      color: #fdf6e3;
      font-family: 'Cinzel Decorative', serif;
    }

    .arcane-border {
      border: 2px solid #b89650;
      box-shadow: 0 0 20px rgba(255, 215, 100, 0.2);
    }

    .title-glow {
      text-shadow: 0 0 15px #f1d17a, 0 0 30px #b89650;
    }

    .parchment {
      background: rgba(40, 32, 18, 0.9);
      backdrop-filter: blur(3px);
      border: 2px solid #b89650;
      box-shadow: 0 0 40px rgba(250, 215, 160, 0.3);
    }

    label {
      font-family: 'MedievalSharp', cursive;
    }

    .seal {
      filter: drop-shadow(0 0 10px #b89650);
    }

    .loading-circle {
      width: 40px;
      height: 40px;
      border: 4px solid #b89650;
      border-top-color: transparent;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }
  </style>
</head>
<body class="min-h-screen flex items-center justify-center p-8">

  <div class="parchment rounded-2xl p-8 max-w-4xl w-full text-center">
    <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/Magic_circle_symbol.svg" alt="Seal" class="mx-auto mb-4 w-20 h-20 seal opacity-80">
    <h1 class="text-4xl font-bold mb-2 title-glow">üìú Imperius Wizard Archive</h1>
    <p class="italic text-yellow-200 mb-8">Registro Oficial de Criaturas M√°gicas</p>

    <form id="creatureForm" class="space-y-6 text-left">

      <!-- Foto do Registrante -->
      <div>
        <label class="block text-lg mb-2">üì∏ Retrato do Registrante</label>
        <input type="file" id="fotoPessoa" accept="image/*" class="block w-full border border-yellow-700 bg-slate-800 bg-opacity-50 p-2 rounded-lg cursor-pointer">
        <div id="previewPessoa" class="mt-3 flex justify-center"></div>
      </div>

      <!-- Foto da Criatura -->
      <div>
        <label class="block text-lg mb-2">üêâ Retrato da Criatura</label>
        <input type="file" id="fotoCriatura" accept="image/*" class="block w-full border border-yellow-700 bg-slate-800 bg-opacity-50 p-2 rounded-lg cursor-pointer">
        <div id="previewCriatura" class="mt-3 flex justify-center"></div>
      </div>

      <!-- Dados da Criatura -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-6">
        <div>
          <label class="block text-lg mb-1">Nome da Criatura:</label>
          <input type="text" id="nome" placeholder="Ex: Feu" class="w-full p-2 rounded-lg bg-slate-900 border border-yellow-700 focus:outline-none">
        </div>
        <div>
          <label class="block text-lg mb-1">Idade Estimada:</label>
          <input type="number" id="idade" placeholder="Ex: 90" class="w-full p-2 rounded-lg bg-slate-900 border border-yellow-700 focus:outline-none">
        </div>
        <div>
          <label class="block text-lg mb-1">Esp√©cie:</label>
          <input type="text" id="especie" placeholder="Ex: Metamorf√≥ide" class="w-full p-2 rounded-lg bg-slate-900 border border-yellow-700 focus:outline-none">
        </div>
        <div>
          <label class="block text-lg mb-1">Sexo:</label>
          <select id="sexo" class="w-full p-2 rounded-lg bg-slate-900 border border-yellow-700 focus:outline-none">
            <option value="">Selecione</option>
            <option value="Macho">Macho</option>
            <option value="F√™mea">F√™mea</option>
            <option value="Indefinido">Indefinido</option>
          </select>
        </div>
        <div class="md:col-span-2">
          <label class="block text-lg mb-1">Tamanho:</label>
          <input type="text" id="tamanho" placeholder="Ex: 80 cm" class="w-full p-2 rounded-lg bg-slate-900 border border-yellow-700 focus:outline-none">
        </div>
      </div>

      <button type="button" id="salvar" class="mt-6 w-full bg-yellow-700 hover:bg-yellow-800 py-3 rounded-lg text-lg font-semibold text-yellow-100 border border-yellow-500 transition">
        ü™∂ Registrar Criatura
      </button>
    </form>

    <!-- Feedback visual -->
    <div id="loading" class="hidden mt-6">
      <div class="loading-circle"></div>
      <p class="mt-3 text-yellow-300 italic">Enviando registro aos Arquivos Imperius...</p>
    </div>

    <div id="resultado" class="mt-10 hidden border-t border-yellow-700 pt-6">
      <h2 class="text-3xl mb-4 text-yellow-400 font-bold">üìñ Registro Gravado</h2>
      <div id="dadosSalvos" class="text-lg space-y-2 font-[MedievalSharp]"></div>
    </div>
  </div>

  <script>
    const fotoPessoa = document.getElementById('fotoPessoa');
    const fotoCriatura = document.getElementById('fotoCriatura');
    const previewPessoa = document.getElementById('previewPessoa');
    const previewCriatura = document.getElementById('previewCriatura');
    const resultado = document.getElementById('resultado');
    const dadosSalvos = document.getElementById('dadosSalvos');
    const loading = document.getElementById('loading');

    const scriptURL = "https://script.google.com/macros/s/AKfycbwkGQ6YFcO2IBR00pHsG1Lsho6Aaxck7mz2RZZZIxQkUG4xqK64_A0poubvMt5gIYmC/exec";

    function previewImage(input, container) {
      container.innerHTML = "";
      const file = input.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = e => {
          const img = document.createElement('img');
          img.src = e.target.result;
          img.className = "rounded-lg shadow-md w-32 h-32 object-cover border border-yellow-700";
          container.appendChild(img);
        };
        reader.readAsDataURL(file);
      }
    }

    fotoPessoa.addEventListener('change', () => previewImage(fotoPessoa, previewPessoa));
    fotoCriatura.addEventListener('change', () => previewImage(fotoCriatura, previewCriatura));

    document.getElementById('salvar').addEventListener('click', async () => {
      const nome = document.getElementById('nome').value.trim();
      const idade = document.getElementById('idade').value.trim();
      const especie = document.getElementById('especie').value.trim();
      const sexo = document.getElementById('sexo').value.trim();
      const tamanho = document.getElementById('tamanho').value.trim();

      if (!nome || !idade || !especie || !sexo || !tamanho) {
        alert("ü™∂ Todos os campos devem ser preenchidos antes do registro!");
        return;
      }

      const getBase64 = file => new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onload = () => resolve(reader.result);
        reader.onerror = reject;
        if (file) reader.readAsDataURL(file);
        else resolve("");
      });

      const fotoPessoa64 = await getBase64(fotoPessoa.files[0]);
      const fotoCriatura64 = await getBase64(fotoCriatura.files[0]);

      const dados = { nome, idade, especie, sexo, tamanho, fotoPessoa: fotoPessoa64, fotoCriatura: fotoCriatura64 };

      loading.classList.remove('hidden');

      try {
        await fetch(scriptURL, {
          method: "POST",
          mode: "no-cors",
          body: JSON.stringify(dados)
        });

        loading.classList.add('hidden');
        resultado.classList.remove('hidden');
        dadosSalvos.innerHTML = `
          <p><strong>Nome:</strong> ${nome}</p>
          <p><strong>Idade:</strong> ${idade} anos</p>
          <p><strong>Esp√©cie:</strong> ${especie}</p>
          <p><strong>Sexo:</strong> ${sexo}</p>
          <p><strong>Tamanho:</strong> ${tamanho}</p>
          <p class="italic text-yellow-400 mt-3">Registro autenticado pela Imperius </p>
        `;
        alert("‚úÖ Registro enviado com sucesso ao Arquivo Imperius!");
      } catch (err) {
        loading.classList.add('hidden');
        alert("‚ùå Falha ao enviar registro: " + err.message);
      }
    });
  </script>
</body>
</html>
